---
title: "Bluesky で GitHub Trending を流すボットを作った"
emoji: "🪂"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["bluesky", "bluesky", "firebase"]
published: false
---

# 🤖 作ったもの
最新の GitHub Trending を定期的に投稿する Bluesky ボットです。 全体のトレンドと、JS/TSのフロントエンドのトレンドを投稿する2つのBotを作りました。

|[GitHub Trending](https://bsky.app/profile/github-trending.bsky.social)|[GitHub Trending JS/TS](https://bsky.app/profile/github-trending-js.bsky.social)
|---|---|
|![](/images/ad4b88908f610b/2023-05-24-09-20-19.png)|![](/images/ad4b88908f610b/2023-05-24-09-19-55.png)|


細かい仕様はこちらです。

- 毎日最新のトレンドを取得
- 30 分から 1 時間おきに GitHub Trending に掲載されているリポジトリをツイート
- 一度投稿したリポジトリは再度掲載されていても 4 日間は投稿しない

コードはすべて以下リポジトリで公開しています。

https://github.com/kawamataryo/bsky-github-trending-bot


# 💘 モチベーション
[こちらの記事](https://zenn.dev/ryo_kawamata/articles/github-trending-bot) で紹介したGitHub Trending を流すTwitter Botを作った時と同様です。

> 複数のつよい人から GitHub Trending を定期的に見て最新の情報をキャッチアップしているという話を聞いたのがはじまりです。自分も見る習慣をつけようと思ったのですがなかなか続かず、それなら毎日見る Twitter のタイムラインで見れるようにすればよいのでは？　と怠惰なモチベーションではじめました。

https://zenn.dev/ryo_kawamata/articles/github-trending-bot

このTwitter Botは1年ほど運用していて8,000フォロワーほどまで成長していたのですが、先日いきなり凍結されてしまいました。解除を申請してもダメで、諦めかかけていたところ、Blueskyの招待コードをもらえたので「Twitterで駄目ならBlueskyで運用だ！」となり、この記事に至ります。

（凍結されてしまったTwitter Botのリポジトリ🥲）
https://github.com/kawamataryo/github-trending-bot


# 🛠️ 実装のポイント

基本的な構成は[以前のTwitter Bot](https://github.com/kawamataryo/github-trending-bot)のコードを流用しているので、今回書き換えた Bluesky への投稿部分を中心に解説します。

## Blueskyのクライアント

BlueskyのATProtocolでの通信は[@atproto/api](https://www.npmjs.com/package/@atproto/api)を使っています。プロダクト上では、@atproto/apiを叩くラッパーの`BskyClient`クラスを定義してそれを使うようにしています。

https://github.com/kawamataryo/bsky-github-trending-bot/blob/main/functions/src/lib/bskyClient.ts#L3-L77


## リッチテキストとリンクカードを使って投稿
投稿時は情報を見やすくするために、リッチテキストとリンクカードを使っています。

![](/images/ad4b88908f610b/2023-05-25-05-25-04.png)


投稿部分はこちらのコードです。GitHub Trendingのリポジトリ情報とエージェントを受け取り、情報を整形して投稿しています。

https://github.com/kawamataryo/bsky-github-trending-bot/blob/main/functions/src/lib/bskyService.ts#L6-L34

`convertLinkText`関数でのリッチテキストへの変換は、[@kawarimidoll](https://twitter.com/kawarimidoll)さんの以下記事のコードをそのまま使わせてもらっています。良記事ありがとうございます🙏

https://zenn.dev/kawarimidoll/articles/42efe3f1e59c13

リンクカードの実装は以前こちらの記事でまとめた手法を使っています。

https://zenn.dev/ryo_kawamata/articles/8d1966f6bb0a82

# 🎬 おわりに

以上GitHub Trendingを流すbskyボットの紹介でした。使ってもらえると嬉しいです。

https://bsky.app/profile/github-trending.bsky.social
https://bsky.app/profile/github-trending-js.bsky.social
