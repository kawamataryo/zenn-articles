---
title: "Google App Script é–‹ç™º ã®ãŸã‚ã® Templateãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œã£ãŸ"
emoji: "ğŸ“”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["gas", "clasp", "typescript", "webpack"]
published: true
---

GAS ã‚’æ›¸ããŸã³ã«é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ã‚’èª¿ã¹ã¦ã„ã‚‹æ°—ãŒã™ã‚‹ã®ã§ã€GAS é–‹ç™ºç”¨ã® Template ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚

# Templateãƒªãƒã‚¸ãƒˆãƒª

https://github.com/kawamataryo/google-app-script-starter-template

æ©Ÿèƒ½ã¯ã“ã¡ã‚‰ã§ã™ã€‚

* [clasp](https://github.com/google/clasp)ã«ã‚ˆã‚‹ App Script ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
* TypeScript å¯¾å¿œ
* Webpack5 ã§ã®ãƒ“ãƒ«ãƒ‰â€»
* [ESLint](https://github.com/eslint/eslint) / [prettier](https://github.com/prettier/prettier) ã§ã®ã‚³ãƒ¼ãƒ‰æ•´å½¢
* [husky](https://github.com/typicode/husky) / [lint-stage](https://github.com/okonet/lint-staged) ã§ã®ãƒ—ãƒ¬ã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯

:::message
Clasp ã‚’ä½¿ãˆã° TypeScrip ã§ã®ãƒ“ãƒ«ãƒ‰ã¯å®Ÿç¾å‡ºæ¥ã‚‹ã®ã§ã™ãŒã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸­ã§ dayjs ãªã© npm ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã—ãŸã„å ´åˆã¯ãƒãƒ³ãƒ‰ãƒ«ãŒå¿…è¦ã§ã™ã€‚ãªã®ã§ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¨ã—ã¦ webpack5 ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚
:::

![](https://i.gyazo.com/b25400e0755d342039b390c3889822b1.png)



# ä½¿ã„æ–¹

GitHub Template ã¨ã—ã¦å…¬é–‹ã—ã¦ã„ã‚‹ã®ã§ã€ãƒªãƒã‚¸ãƒˆãƒªã®`Use this template`ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚Œã°ã€ã‚³ãƒŸãƒƒãƒˆå±¥æ­´ãŒå‰Šé™¤ã•ã‚ŒãŸè‡ªåˆ†ã®ãƒªãƒã‚¸ãƒˆãƒªã¨ã—ã¦ä½œæˆã§ãã¾ã™ã€‚

https://github.com/kawamataryo/google-app-script-starter-template/generate

![](https://i.gyazo.com/d61f9538d7faded06d9ec7221e923dc6.png)

ä½œæˆã—ãŸãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã« clone ã—ãŸã‚‰ã€`.clasp.json`ã®`scriptId`ã‚’è‡ªèº«ã® AppScript ã® ID ã§æ›¸ãæ›ãˆã¦ãã ã•ã„ã€‚

```json:.clasp.json
{
  "scriptId": "<YOUR_SCRIPT_ID>",
  "rootDir": "./dist"
}
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã¯`src/main.ts`ã§ã™ã€‚

```ts:src/main.ts
const greeting = () => {
  Logger.log("Hello World");
};

(global as any).greeting = greeting;
```

`main.ts` ã§ `(global as any).é–¢æ•°å = é–¢æ•°;`ã¨ã™ã‚Œã°ã€ãã®é–¢æ•°ãŒå…¬é–‹ã•ã‚Œã¾ã™ã€‚

:::message
global ã«é–¢æ•°ã‚’ç™»éŒ²ã™ã‚‹ã®ã¯ GAS ãŒãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§é–¢æ•°å®£è¨€ã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚webpack ã®ãƒãƒ³ãƒ‰ãƒ«å¾Œã‚‚ã€ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§ã®é–¢æ•°å®£è¨€ã‚’ä¿æŒã™ã‚‹ãŸã‚ã« [gas-webpack-plugin](https://github.com/fossamagna/gas-webpack-plugin)ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚
:::

ãƒ“ãƒ«ãƒ‰ç­‰ npm ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚

```json:package.json
  "scripts": {
    "build": "webpack",
    "deploy": "yarn build && clasp push",
    "lint": "prettier 'src/**/*.ts' && eslint 'src/**/*.ts'",
    "lint:fix": "prettier --write 'src/**/*.ts' && eslint --fix 'src/**/*.ts'",
    "prepare": "husky install"
  },
```

# çµ‚ã‚ã‚Šã«
å¿«é©ãª GAS ãƒ©ã‚¤ãƒ•ã‚’ã€‚
ã‚ˆã‚Šè‰¯ã„æ–¹æ³•ã‚„ãªã©ã‚ã‚Šã¾ã—ãŸã‚‰æ°—è»½ã« Issueã€PR æŠ•ã’ã¦é ‚ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ğŸ™